<div class="dashboard-container">
  <div class="header">
    <div class="header-content">
      <div class="header-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
        </svg>
      </div>
      <h1>ITSI Labor Dashboard</h1>
    </div>
    <button class="logout-button" (click)="logout()">
      Abmelden
    </button>
  </div>

  <div class="stats-grid">
    <div class="stat-card total">
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
        </svg>
      </div>
      <div class="stat-content">
        <span class="stat-value">{{ stats().total }}</span>
        <span class="stat-label">Gesamt Aufgaben</span>
      </div>
    </div>

    <div class="stat-card not-started">
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
        </svg>
      </div>
      <div class="stat-content">
        <span class="stat-value">{{ stats().notStarted }}</span>
        <span class="stat-label">Nicht begonnen</span>
      </div>
    </div>

    <div class="stat-card in-progress">
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
      </div>
      <div class="stat-content">
        <span class="stat-value">{{ stats().inProgress }}</span>
        <span class="stat-label">In Bearbeitung</span>
      </div>
    </div>

    <div class="stat-card completed">
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
        </svg>
      </div>
      <div class="stat-content">
        <span class="stat-value">{{ stats().completed }}</span>
        <span class="stat-label">Abgeschlossen</span>
      </div>
    </div>
  </div>

  <div class="exercises-section">
    <h2>Ãœbungsaufgaben</h2>

    <div class="exercise-list">
      @for (exercise of exercises(); track exercise.id) {
        <div class="exercise-card"
             [attr.data-status]="exercise.status"
             tabindex="0"
             role="button"
             (click)="onExerciseClick(exercise)"
             (keydown.enter)="onExerciseClick(exercise)"
             (keydown.space)="onExerciseClick(exercise)">
          <div class="exercise-header">
            <div class="exercise-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
              </svg>
            </div>
            <div class="exercise-title">
              <h3>{{ exercise.title }}</h3>
              @if (exercise.description) {
                <p class="description">{{ exercise.description }}</p>
              }
            </div>
          </div>

          <div class="status-selector"
               tabindex="-1"
               (click)="$event.stopPropagation()"
               (keydown)="$event.stopPropagation()">
            <span class="status-label">Status:</span>
            <div class="status-buttons">
              <button
                type="button"
                class="status-button"
                [class.active]="exercise.status === 'not-started'"
                (click)="onStatusChange(exercise.id, 'not-started')">
                Nicht begonnen
              </button>
              <button
                type="button"
                class="status-button"
                [class.active]="exercise.status === 'in-progress'"
                (click)="onStatusChange(exercise.id, 'in-progress')">
                In Bearbeitung
              </button>
              <button
                type="button"
                class="status-button"
                [class.active]="exercise.status === 'completed'"
                (click)="onStatusChange(exercise.id, 'completed')">
                Abgeschlossen
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
